%script{ type: 'text/ng-template', id: 'item_entry_form.html' }

  .new-item-form
    .setplanbox-on-plan-page
      .input-and-results{ ng_show: '!list' }
        .faux-input-wrap
          %span.add-new{ ng_show: 'canAddList()', ng_click: 'setList()' }
            %i.fa.fa-plus-circle
          %input.real-select.guide-name#guide{ name: "guide", type: 'text', placeholder: 'Guide Name', ng_model: 'listQuery', ng_on_enter_key: "setListOnEnter()", ng_class: "{'full-width': !canAddList()}" }
        %ul.suggested-results{ ng_show: 'listOptions().length && listQuery.length > 2' }
          %li{ ng_repeat: "currentList in listOptions()", ng_click: 'setList(currentList)' }
            %span.name {{currentList.name}}
            %span.count ({{currentList.place_ids.length}} places)
      .chosen-plan{ ng_show: 'list && !rename' }
        %span.title{ ng_click: 'renameList()' } {{ list.name }}
        %i.fa.fa-times.title{ ng_click: 'resetList()' }
        %a{ ng_href: '/api/v1/plans/{{list.id}}/kml' }
          %i.fa.fa-cog.settings
      .chosen-plan.above-mask{ ng_show: 'list && rename' }
        %input.title#rename{ ng_model: 'rename', ng_on_enter_key: 'saveRenameList()', ng_on_esc_key: 'cancelRenameList()' }
        / .planit-button{ ng_click: 'saveRenameList()' } Save
        / .planit-button{ ng_click: 'cancelRenamelist()' } Cancel
    .addbox-on-plan-page{ ng_show: 'list' }
      .faux-input-wrap{ ng_show: '!nearby && list' }
        %span.add-new{ ng_show: 'canSetNearby(placeNearby)', ng_click: 'setNearby(placeNearby)' }
          %i.fa.fa-check
        %input.real-select#place-nearby{ name: "place-nearby", type: 'text', placeholder: 'Where? (City or Region)', ng_model: 'placeNearby', ng_show: 'list && !nearby', ng_on_enter_key: 'setNearby(placeNearby)', ng_class: "{'full-width': (!placeNearby || placeNearby.length < 2)}" }
      .input-and-results{ ng_show: 'nearby && list' }
        .faux-input-wrap
          %span.chosen-input#chosen-nearby{ ng_click: 'resetNearby()' }
            %i.fa.fa-times
            {{ nearby }}
          %input.real-input#place-name{ name: "place-name", type: 'text', placeholder: 'Add a Place (Search by Name)', ng_model: 'placeName', ng_change: 'search()', ng_on_enter_key: "lazyAddItem()", ng_keydown: 'removeTagOnBackspace($event)' }
        %ul.suggested-results{ ng_show: 'options.length > 0' }
          %li.search-results-list{ ng_repeat: 'option in options', ng_click: 'addItem(option)' }
            .bucket-list-tab
              %a{ ng_href: '{{option.href}}' }
                .bucket-list-no-img{ ng_show: "!option.image_url" }
                .bucket-list-img{ ng_show: "option.image_url", style: "background-image: url('{{ option.image_url }}');" }
              .bucket-list-wrap
                .bucket-list-profile
                  %a
                    .bucket-list-title
                      {{ option.names[0] }}
                    .foursquare-and-info-wrap
                      %span.mini-foursquare-icon{ ng_show: "option.icon", style: "background-image: url('{{ option.icon }}');" }
                      .bucket-list-more-info
                        {{ option.categories.join(', ') }}
                      .bucket-list-more-info.locale-only
                        {{ option.localeDetails() }}

    .sort-items-by.large-screen
      %b Sort by
      %span.sort-by-button{ ng_click: "setCategoryAs('alphabetical')", ng_class: "{'highlighted': categoryIs == 'alphabetical'}" } A-Z
      %span.sort-by-button{ ng_click: "setCategoryAs('type')", ng_class: "{'highlighted': categoryIs == 'type'}" } Type
      %span.sort-by-button{ ng_click: "setCategoryAs('locale')", ng_class: "{'highlighted': categoryIs == 'locale'}" } Locale
      / %span.sort-by-button{ ng_click: "setCategoryAs('recent')", ng_class: "{'highlighted': categoryIs == 'recent'}" } When Added

    .view-and-edit-mode.large-screen
      %span.view-and-edit-button.highlighted List
      %span.view-and-edit-button.disabled Trip
      %span.view-and-edit-button Map
      %b View Mode

    .band.spaced-extra
      .container
        .sixteen-columns.items-in-plan{ ng_repeat: 'category in categories' }
          .items-organized-by{ ng_show: "categoryIs != 'alphabetical'" }
            %i.fa{ ng_show: "categoryIs == 'type'", ng_class: 'typeIcon(category)' } 
            {{ category }}
          %ul.plan-list-items{ ng_class: "{'border-top': categoryIs == 'alphabetical'}" }
            %li.plan-list-item{ ng_repeat: 'item in matchingItems( category )' }
              .bucket-list-tab
                %a{ ng_href: '{{item.mark.place.href}}' }
                  .bucket-list-no-img{ ng_if: "!item.mark.place.image_url" }
                  .bucket-list-img{ ng_if: "item.mark.place.image_url", style: "background-image: url('{{ item.mark.place.image_url }}');" }
                .bucket-list-wrap
                  .bucket-list-profile
                    %a
                      .bucket-list-title
                        {{ item.mark.place.names[0] }}
                      .bucket-list-more-info
                        %i{ class: "{{ item.mark.place.meta_icon }}"}
                        {{ item.mark.place.categories.join(', ') }}
                      .bucket-list-more-info.locale-only
                        {{ item.mark.place.localeDetails() }}
              .list-item-notes.largest-screen
                %textarea{ id: "item_{{item.id}}", placeholder: "Add a Note", ng_on_enter_key: 'saveNote(item)' } {{currentNote( item )}}
