.exit-view
  %a{href: plan_path} Exit Print View
.logo-container
  = image_tag "white_logo.png"
  = image_tag "white_tagline.png", id: "tagline"
=image_tag "#{image_path @data.moneyshots[0]['url']}", style: "width: 750px; max-height: 750px", html: { border: "0" }
.moneyshot-caption= "\"#{@data.moneyshots[0]['subtitle']}\""
.print-page-header
  %strong
    = @data.title
  .print-header-subtitle
    = "#{@data.legs.length} legs / #{leg_end(@data.legs.compact.last)['parent_day']} days"

.break-page
// break page

.print-page-header
  = image_tag "black_logo_only.png"
  %strong
    = "#{@data.title}:"
  .print-header-subtitle
    Overview

%map{ style: 'height: 750px; width: 750px', icon: image_path('pin_sm_red_19x22.png'), coordinates: overview_coordinates(@data), type: 'print'}

.break-page
// break page

.print-page-header
  = image_tag "black_logo_only.png"
  %strong
    = "#{@data.title}:"
  .print-header-subtitle
    Summary, Tips & Reminders

.summary-author
  = "#{@data.author}, #{@data.trailblaze_date}"
.summary-content
  = @data.summary_text
  
Tips
Reminders

.break-page
// break page

.print-page-header
  = image_tag "black_logo_only.png"
  %strong
    = "#{@data.title}:"
  .print-header-subtitle
    Transit & Transportation

- @data.legs.each_with_index do |leg, index|
  - if leg['arrival']
    - if leg['arrival']['legs']
      - leg['arrival']['legs'].each_with_index do |travel_info, index|
        .content-tab-wrap
          .content-tab-print.time
            =image_tag "travel-by-#{leg['arrival']['method']}.png"
          .content-tab-print.info
            = print_flight(travel_info, index)
    - else
      .content-tab-wrap
        .content-tab-print.time
          =image_tag "travel-by-#{leg['arrival']['method']}.png"
        .content-tab-print.info
          = "#{leg['arrival']['method']} on #{leg_start(leg)['parent_day']}"
  / - days(leg).each_with_index do |day, index|
  /   - items(day).select{ |i| i['travel_data'] }.each_with_index do |travel_info, index|
  /     = print_flight(travel_info, index)
  - if leg['departure']
    - if leg['departure']['legs']
      - leg['departure']['legs'].each_with_index do |travel_info, index|
        .content-tab-wrap
          .content-tab-print.time
            =image_tag "travel-by-#{travel_info['method']}.png"
          .content-tab-print.info
            = print_flight(travel_info, index)
    - else
      .content-tab-wrap
        .content-tab-print.time
          =image_tag "travel-by-#{leg['departure']['method']}.png"
        .content-tab-print.info
          = "#{leg['departure']['method']} on #{leg_end(leg)['parent_day']}"

.break-page
// break page

.print-page-header
  = image_tag "black_logo_only.png"
  %strong
    = "#{@data.title}:"
  .print-header-subtitle
    Accomodations

/ - @data.legs.each_with_index do |leg, index|

/   - days(leg).each_with_index do |day, index|

/     - items(day).select{ |i| i['lodging'] }.each_with_index do |item, index|
/       .content-tab-wrap
/         .content-tab-print.time
/           = "Days 1-3"
/         .content-tab-print.info
/           = item['name']

// BY SECTION

- @data.legs.each_with_index do |leg, index|
  .break-page
  // break page
  .print-page-header
    = image_tag "black_logo_only.png"
    .timeline-cluster
      = image_tag "timeline-cluster-pin-#{index + 1}.png"
    %strong
      = "#{@data.title}"
    .print-header-subtitle
      = leg['name']
      %b= " (Day #{leg_start(leg)['parent_day']} to #{leg_end(leg)['parent_day']})"
  %map.map-container{ icon: image_path('pin_sm_red_19x22.png'), coordinates: leg_coordinates(leg), type: 'print' }
  
  .print-end
  .break-page
  // break page

  .print-page-header
    = image_tag "black_logo_only.png"
    .timeline-cluster
      = image_tag "timeline-cluster-pin-#{index + 1}.png"
    %strong
      = "#{@data.title}"
    .print-header-subtitle
      = leg['name']
      %b= " (Day #{leg_start(leg)['parent_day']} to #{leg_end(leg)['parent_day']})"
  - if leg['arrival']
    .content-tab-wrap
      .content-tab-print.time
        =image_tag "travel-by-#{leg['arrival']['method']}.png"
      .content-tab-print.travel
        = "Arrive by "
        %b= "#{leg['arrival']['method']}"
  - days(leg).each_with_index do |day, index|
    .content-tab-wrap
      .content-tab-print.time
        =image_tag "timeline_date_#{day['items'][0]['parent_day']}.png"
      .content-tab-print.date
        %b= "Day #{day['items'][0]['parent_day']}"
        - if @data.start_date
          = ": #{display_date(@data, day['items'][0]).strftime('%b %d, %Y')}"
    - day['items'].each_with_index do |item, index|
      .content-tab-wrap
        .content-tab-print.time
          - if day['time_of_day']             
            =image_tag "timeline_#{day['time_of_day']}.png"
          - else
            =image_tag "timeline_afternoon.png"
          / .plan-content-time{ class: day_group }
          .content-tab-timestamp
            - if day['time_of_day']
              = "#{day['time_of_day']}, "  
            - if @data.start_date
              = display_date(@data, item).strftime("%b %d, %Y")
        .content-tab-print.image
          .content-tab-title
            - if item['name']
              %b= item['name']
          - if item['tab_image']
            = image_tag item['tab_image']
        .content-tab-print.info
          - if item['lodging']
            .content-tab-more-info
              - if @data.start_date
                = "Stay the night (#{display_date(@data, item).strftime ("%m/%d/%Y")})"
          - if item['category']
            .content-tab-more-info
              = item['category']
          - if item['notes']
            .content-tab-more-info
              %b Notes:
              = item['notes']
          - if item['website']
            .content-tab-more-info
              %b Website:
              = item['website']
          - if item['phone']
            .content-tab-more-info
              %b Phone:
              = item['phone']
          - if item['source']
            .content-tab-get-more
              %b= "#{item['source']}"
              ="#{item['source_url']}"
        .content-tab-print.location
          - if item['local_name'] && item['local_name'].downcase != item['name'].downcase
            .content-tab-timestamp
              = " (#{item['local_name']})"
          - if item['lat'] && item['lon']
            %map.item-map-container{ icon: image_path('pin_sm_red_19x22.png'), coordinates: coordinate(item), type: "detail" }
          - else
            = image_tag "no_map_180x180.png", {style: "height: 180px; width: 180px"}
          - if item['address']
            .content-tab-more-info
              = item['address']

  - if leg['departure']
    .content-tab-wrap
      .content-tab-print.time
        =image_tag "travel-by-#{leg['departure']['method']}.png"
      .content-tab-print.travel
        = "Depart by "
        %b= "#{leg['departure']['method']}"
  .print-end

.break-page

.footer
  .footer-content
    Print version message
